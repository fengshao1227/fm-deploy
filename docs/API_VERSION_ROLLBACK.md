# ç§»åŠ¨ç«¯ API äº¤æ¥æ–‡æ¡£

> åˆ›å»ºæ—¶é—´: 2025-12-01

## åŠŸèƒ½æ¦‚è¿°

åç«¯å·²å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š

### 1. é¡¹ç›®ç®¡ç†
- åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤é¡¹ç›®
- ä¸ºé¡¹ç›®é…ç½®ä¸åŒç¯å¢ƒï¼ˆæµ‹è¯•/ç”Ÿäº§ï¼‰çš„éƒ¨ç½²è®¾ç½®

### 2. å¤šåˆ†æ”¯éƒ¨ç½²æ”¯æŒ
- æ¯ä¸ªã€Œé¡¹ç›®ç¯å¢ƒé…ç½®ã€å¯ä»¥è®¾ç½®ç‹¬ç«‹çš„åˆ†æ”¯
- ä¾‹å¦‚ï¼šæµ‹è¯•ç¯å¢ƒç”¨ `develop` åˆ†æ”¯ï¼Œç”Ÿäº§ç¯å¢ƒç”¨ `master` åˆ†æ”¯
- éƒ¨ç½²æ—¶ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°é…ç½®çš„åˆ†æ”¯è¿›è¡Œæ„å»º/æ‹‰å–

### 3. ç‰ˆæœ¬å¤‡ä»½ä¸å›æ»šï¼ˆPush æ¨¡å¼ï¼‰
- æ¯æ¬¡éƒ¨ç½²æ—¶ï¼Œè‡ªåŠ¨å°†æœåŠ¡å™¨ä¸Šçš„ç°æœ‰ dist ç›®å½•å¤‡ä»½ä¸º `dist_æ—¶é—´æˆ³` æ ¼å¼
- æä¾› API æŸ¥è¯¢å¯å›æ»šçš„å†å²ç‰ˆæœ¬åˆ—è¡¨
- æä¾› API æ‰§è¡Œå›æ»šåˆ°æŒ‡å®šå†å²ç‰ˆæœ¬

---

## é¡¹ç›®ç®¡ç† API

### 1. è·å–æ‰€æœ‰é¡¹ç›®ï¼ˆç®€å•åˆ—è¡¨ï¼‰

**è¯·æ±‚**
```
GET /api/projects/all
```

**å“åº”**
```json
{
  "success": true,
  "data": [
    { "id": 1, "name": "å‰ç«¯é¡¹ç›®", "projectKey": "frontend", "type": "frontend" },
    { "id": 2, "name": "åç«¯æœåŠ¡", "projectKey": "backend-api", "type": "backend" }
  ]
}
```

### 2. è·å–é¡¹ç›®åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰

**è¯·æ±‚**
```
GET /api/projects?keyword=&type=&page=1&pageSize=10
```

**å‚æ•°**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| keyword | string | å¦ | æœç´¢å…³é”®å­—ï¼ˆåŒ¹é…åç§°æˆ–æ ‡è¯†ï¼‰ |
| type | string | å¦ | é¡¹ç›®ç±»å‹ï¼š`frontend` / `backend` |
| page | number | å¦ | é¡µç ï¼Œé»˜è®¤ 1 |
| pageSize | number | å¦ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ 10 |

**å“åº”**
```json
{
  "success": true,
  "data": {
    "list": [
      {
        "id": 1,
        "name": "å‰ç«¯é¡¹ç›®",
        "projectKey": "frontend",
        "type": "frontend",
        "gitRepo": "git@github.com:user/frontend.git",
        "description": "å…¬å¸å‰ç«¯é¡¹ç›®",
        "createdAt": "2025-12-01T10:00:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "pageSize": 10,
      "total": 1,
      "totalPages": 1
    }
  }
}
```

### 3. è·å–é¡¹ç›®è¯¦æƒ…

**è¯·æ±‚**
```
GET /api/projects/:id
```

**å“åº”**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "name": "å‰ç«¯é¡¹ç›®",
    "projectKey": "frontend",
    "type": "frontend",
    "gitRepo": "git@github.com:user/frontend.git",
    "description": "å…¬å¸å‰ç«¯é¡¹ç›®",
    "createdAt": "2025-12-01T10:00:00.000Z",
    "projectEnvironments": [
      {
        "id": 1,
        "branch": "develop",
        "deployMode": "push",
        "environment": { "id": 1, "name": "æµ‹è¯•ç¯å¢ƒ" }
      },
      {
        "id": 2,
        "branch": "master",
        "deployMode": "push",
        "environment": { "id": 2, "name": "ç”Ÿäº§ç¯å¢ƒ" }
      }
    ]
  }
}
```

### 4. åˆ›å»ºé¡¹ç›®

**è¯·æ±‚**
```
POST /api/projects
```

**æƒé™**: éœ€è¦ admin è§’è‰²

**è¯·æ±‚ä½“**
```json
{
  "name": "æ–°é¡¹ç›®",
  "projectKey": "new-project",
  "type": "frontend",
  "gitRepo": "git@github.com:user/new-project.git",
  "description": "é¡¹ç›®æè¿°ï¼ˆå¯é€‰ï¼‰"
}
```

**å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| name | string | æ˜¯ | é¡¹ç›®åç§° |
| projectKey | string | æ˜¯ | é¡¹ç›®æ ‡è¯†ï¼ˆå”¯ä¸€ï¼Œå­—æ¯å¼€å¤´ï¼Œåªèƒ½åŒ…å«å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ä¸­åˆ’çº¿ï¼‰ |
| type | string | æ˜¯ | é¡¹ç›®ç±»å‹ï¼š`frontend` / `backend` |
| gitRepo | string | å¦ | Git ä»“åº“åœ°å€ |
| description | string | å¦ | é¡¹ç›®æè¿° |

**å“åº”**
```json
{
  "success": true,
  "data": {
    "id": 3,
    "name": "æ–°é¡¹ç›®",
    "projectKey": "new-project",
    "type": "frontend",
    "gitRepo": "git@github.com:user/new-project.git",
    "description": "é¡¹ç›®æè¿°",
    "createdAt": "2025-12-01T12:00:00.000Z"
  },
  "message": "é¡¹ç›®åˆ›å»ºæˆåŠŸ"
}
```

**é”™è¯¯å“åº”**
```json
{ "success": false, "error": "é¡¹ç›®åç§°ã€é¡¹ç›®æ ‡è¯†å’Œç±»å‹ä¸ºå¿…å¡«é¡¹" }
{ "success": false, "error": "é¡¹ç›®ç±»å‹å¿…é¡»æ˜¯ frontend æˆ– backend" }
{ "success": false, "error": "é¡¹ç›®æ ‡è¯†å¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’Œä¸­åˆ’çº¿" }
{ "success": false, "error": "é¡¹ç›®æ ‡è¯†å·²å­˜åœ¨" }
```

### 5. æ›´æ–°é¡¹ç›®

**è¯·æ±‚**
```
PUT /api/projects/:id
```

**æƒé™**: éœ€è¦ admin è§’è‰²

**è¯·æ±‚ä½“**
```json
{
  "name": "æ–°åç§°",
  "gitRepo": "git@github.com:user/updated.git",
  "description": "æ›´æ–°çš„æè¿°"
}
```

**æ³¨æ„**: `projectKey` å’Œ `type` åˆ›å»ºåä¸å¯ä¿®æ”¹

### 6. åˆ é™¤é¡¹ç›®

**è¯·æ±‚**
```
DELETE /api/projects/:id
```

**æƒé™**: éœ€è¦ admin è§’è‰²

**æ³¨æ„**: å¦‚æœé¡¹ç›®ä¸‹å­˜åœ¨ç¯å¢ƒé…ç½®ï¼Œéœ€è¦å…ˆåˆ é™¤ç¯å¢ƒé…ç½®

---

## é¡¹ç›®ç¯å¢ƒé…ç½® API

### 1. è·å–é¡¹ç›®çš„ç¯å¢ƒé…ç½®åˆ—è¡¨

**è¯·æ±‚**
```
GET /api/projects/:projectId/environments
```

**å“åº”**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "projectId": 1,
      "environmentId": 1,
      "deployPath": "/var/www/project/dist",
      "branch": "develop",
      "deployMode": "push",
      "buildOutputPath": "dist",
      "buildCommand": "npm run build",
      "enabled": true,
      "environment": { "id": 1, "name": "æµ‹è¯•ç¯å¢ƒ" }
    }
  ]
}
```

### 2. åˆ›å»ºé¡¹ç›®ç¯å¢ƒé…ç½®

**è¯·æ±‚**
```
POST /api/projects/:projectId/environments
```

**æƒé™**: éœ€è¦ admin è§’è‰²

**è¯·æ±‚ä½“**
```json
{
  "environmentId": 1,
  "deployPath": "/var/www/project/dist",
  "branch": "develop",
  "deployMode": "push",
  "buildOutputPath": "dist",
  "buildCommand": "npm run build",
  "preDeployCommand": "",
  "postDeployCommand": ""
}
```

**å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| environmentId | number | æ˜¯ | ç¯å¢ƒ ID |
| deployPath | string | æ˜¯ | éƒ¨ç½²è·¯å¾„ |
| branch | string | å¦ | Git åˆ†æ”¯ï¼Œé»˜è®¤ `master` |
| deployMode | string | å¦ | éƒ¨ç½²æ¨¡å¼ï¼š`push` / `pull`ï¼Œé»˜è®¤ `push` |
| buildOutputPath | string | å¦ | æ„å»ºè¾“å‡ºç›®å½•ï¼Œé»˜è®¤ `dist` |
| buildCommand | string | å¦ | æ„å»ºå‘½ä»¤ |
| preDeployCommand | string | å¦ | éƒ¨ç½²å‰å‘½ä»¤ |
| postDeployCommand | string | å¦ | éƒ¨ç½²åå‘½ä»¤ |

### 3. æ›´æ–°é¡¹ç›®ç¯å¢ƒé…ç½®

**è¯·æ±‚**
```
PUT /api/project-environments/:id
```

**æƒé™**: éœ€è¦ admin è§’è‰²

**è¯·æ±‚ä½“**ï¼ˆæ‰€æœ‰å­—æ®µå¯é€‰ï¼‰
```json
{
  "branch": "master",
  "deployPath": "/var/www/project-prod/dist",
  "buildCommand": "npm run build:prod"
}
```

---

## ç¯å¢ƒç®¡ç† API

### 1. è·å–æ‰€æœ‰ç¯å¢ƒ

**è¯·æ±‚**
```
GET /api/environments/all
```

**å“åº”**
```json
{
  "success": true,
  "data": [
    { "id": 1, "name": "æµ‹è¯•ç¯å¢ƒ" },
    { "id": 2, "name": "ç”Ÿäº§ç¯å¢ƒ" }
  ]
}
```

### 2. åˆ›å»ºç¯å¢ƒ

**è¯·æ±‚**
```
POST /api/environments
```

**æƒé™**: éœ€è¦ admin è§’è‰²

**è¯·æ±‚ä½“**
```json
{
  "name": "æµ‹è¯•ç¯å¢ƒ",
  "sshHost": "192.168.1.100",
  "sshPort": 22,
  "sshUser": "deploy",
  "sshKeyPath": "/path/to/key"
}
```

---

## ç§»åŠ¨ç«¯ UI å»ºè®®ï¼ˆé¡¹ç›®ç®¡ç†ï¼‰

### é¡¹ç›®åˆ—è¡¨é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é¡¹ç›®ç®¡ç†                      [+]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸŒ å‰ç«¯é¡¹ç›®                         â”‚
â”‚     frontend | 2 ä¸ªç¯å¢ƒé…ç½®          â”‚
â”‚                                     â”‚
â”‚  âš™ï¸ åç«¯æœåŠ¡                         â”‚
â”‚     backend-api | 1 ä¸ªç¯å¢ƒé…ç½®       â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ·»åŠ é¡¹ç›®é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ é¡¹ç›®                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  é¡¹ç›®åç§° *                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  é¡¹ç›®æ ‡è¯† *                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  åªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€ä¸­åˆ’çº¿   â”‚
â”‚                                     â”‚
â”‚  é¡¹ç›®ç±»å‹ *                          â”‚
â”‚  â—‹ å‰ç«¯é¡¹ç›® (frontend)              â”‚
â”‚  â—‹ åç«¯é¡¹ç›® (backend)               â”‚
â”‚                                     â”‚
â”‚  Git ä»“åº“åœ°å€                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  git@github.com:user/repo   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  é¡¹ç›®æè¿°                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              [åˆ›å»ºé¡¹ç›®]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ·»åŠ ç¯å¢ƒé…ç½®é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ ç¯å¢ƒé…ç½®                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  é€‰æ‹©ç¯å¢ƒ *                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æµ‹è¯•ç¯å¢ƒ                 â–¼  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  éƒ¨ç½²åˆ†æ”¯                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  develop                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  éƒ¨ç½²æ¨¡å¼                            â”‚
â”‚  â—‹ Push (æœ¬åœ°æ„å»ºä¸Šä¼ )              â”‚
â”‚  â—‹ Pull (æœåŠ¡å™¨æ‹‰å–æ„å»º)            â”‚
â”‚                                     â”‚
â”‚  éƒ¨ç½²è·¯å¾„ *                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /var/www/project/dist      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  æ„å»ºå‘½ä»¤                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  npm run build              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              [ä¿å­˜é…ç½®]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åˆ†æ”¯ç®¡ç† APIï¼ˆå·²æœ‰æ¥å£ï¼‰

### 1. è·å–é¡¹ç›®ç¯å¢ƒé…ç½®è¯¦æƒ…ï¼ˆå«åˆ†æ”¯ä¿¡æ¯ï¼‰

**è¯·æ±‚**
```
GET /api/project-environments/:id
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "projectId": 1,
    "environmentId": 1,
    "deployPath": "/var/www/project/dist",
    "branch": "develop",
    "deployMode": "push",
    "buildOutputPath": "dist",
    "buildCommand": "npm run build",
    "preDeployCommand": null,
    "postDeployCommand": null,
    "enabled": true,
    "project": { "id": 1, "name": "å‰ç«¯é¡¹ç›®", "projectKey": "frontend" },
    "environment": { "id": 1, "name": "æµ‹è¯•ç¯å¢ƒ" }
  }
}
```

### 2. æ›´æ–°åˆ†æ”¯é…ç½®

**è¯·æ±‚**
```
PUT /api/project-environments/:id
```

**è¯·æ±‚ä½“**
```json
{
  "branch": "master"
}
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "branch": "master",
    ...
  },
  "message": "é¡¹ç›®ç¯å¢ƒé…ç½®æ›´æ–°æˆåŠŸ"
}
```

**å¯æ›´æ–°å­—æ®µ**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| branch | string | Git åˆ†æ”¯åç§° |
| deployPath | string | éƒ¨ç½²è·¯å¾„ |
| deployMode | string | éƒ¨ç½²æ¨¡å¼ (`push` / `pull`) |
| buildOutputPath | string | æ„å»ºè¾“å‡ºç›®å½• |
| buildCommand | string | æ„å»ºå‘½ä»¤ |
| preDeployCommand | string | éƒ¨ç½²å‰å‘½ä»¤ |
| postDeployCommand | string | éƒ¨ç½²åå‘½ä»¤ |
| enabled | boolean | æ˜¯å¦å¯ç”¨ |

### 3. åˆ›å»ºé¡¹ç›®ç¯å¢ƒé…ç½®ï¼ˆæŒ‡å®šåˆ†æ”¯ï¼‰

**è¯·æ±‚**
```
POST /api/projects/:projectId/environments
```

**è¯·æ±‚ä½“**
```json
{
  "environmentId": 2,
  "deployPath": "/var/www/project-prod/dist",
  "branch": "master",
  "deployMode": "push",
  "buildCommand": "npm run build:prod"
}
```

---

## éƒ¨ç½²æµç¨‹è¯´æ˜

### Push æ¨¡å¼ï¼ˆå‰ç«¯é¡¹ç›®ï¼‰
```
1. æœ¬åœ°å…‹éš†/æ‹‰å–ä»£ç 
2. åˆ‡æ¢åˆ°é…ç½®çš„åˆ†æ”¯ (git checkout {branch})
3. æ‹‰å–æœ€æ–°ä»£ç  (git pull origin {branch})
4. æ‰§è¡Œæ„å»ºå‘½ä»¤
5. ã€æ–°å¢ã€‘å¤‡ä»½æœåŠ¡å™¨ç°æœ‰ç›®å½•ä¸º dist_æ—¶é—´æˆ³
6. ä¸Šä¼ æ„å»ºäº§ç‰©åˆ°æœåŠ¡å™¨
7. æ‰§è¡Œéƒ¨ç½²åå‘½ä»¤
```

### Pull æ¨¡å¼ï¼ˆåç«¯é¡¹ç›®ï¼‰
```
1. SSH è¿æ¥æœåŠ¡å™¨
2. è¿›å…¥éƒ¨ç½²ç›®å½•
3. åˆ‡æ¢åˆ°é…ç½®çš„åˆ†æ”¯ (git checkout {branch})
4. æ‹‰å–æœ€æ–°ä»£ç  (git pull origin {branch})
5. æ‰§è¡Œæ„å»ºå‘½ä»¤
6. æ‰§è¡Œéƒ¨ç½²åå‘½ä»¤
```

---

## ç§»åŠ¨ç«¯ UI å»ºè®®ï¼ˆåˆ†æ”¯ç®¡ç†ï¼‰

### é¡¹ç›®ç¯å¢ƒé…ç½®ç¼–è¾‘é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¼–è¾‘ç¯å¢ƒé…ç½®                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  éƒ¨ç½²åˆ†æ”¯                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  develop                 â–¼  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  å¸¸ç”¨: master / develop / main      â”‚
â”‚                                     â”‚
â”‚  éƒ¨ç½²æ¨¡å¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Push (æœ¬åœ°æ„å»ºä¸Šä¼ )      â–¼  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  éƒ¨ç½²è·¯å¾„                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /var/www/project/dist      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  æ„å»ºå‘½ä»¤                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  npm run build              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              [ä¿å­˜]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### éƒ¨ç½²ç¡®è®¤é¡µï¼ˆæ˜¾ç¤ºåˆ†æ”¯ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ç¡®è®¤éƒ¨ç½²ï¼Ÿ                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  é¡¹ç›®: å‰ç«¯é¡¹ç›®                      â”‚
â”‚  ç¯å¢ƒ: æµ‹è¯•ç¯å¢ƒ                      â”‚
â”‚  åˆ†æ”¯: develop  â† æ˜¾ç¤ºå½“å‰åˆ†æ”¯       â”‚
â”‚  æ¨¡å¼: Push (æœ¬åœ°æ„å»ºä¸Šä¼ )           â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      [å–æ¶ˆ]          [å¼€å§‹éƒ¨ç½²]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ–°å¢ API æ¥å£

### 1. è·å–å¯å›æ»šç‰ˆæœ¬åˆ—è¡¨

**è¯·æ±‚**
```
GET /api/project-environments/:id/versions
```

**å‚æ•°**
| å‚æ•° | ä½ç½® | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|------|
| id | path | number | æ˜¯ | é¡¹ç›®ç¯å¢ƒé…ç½® ID |

**è¯·æ±‚å¤´**
```
Authorization: Bearer <token>
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "projectEnvironmentId": 1,
    "versions": [
      {
        "id": 5,
        "name": "dist_20251201_103000",
        "path": "/var/www/project/dist_20251201_103000",
        "createdAt": "2025-12-01T10:30:00.000Z",
        "deploymentId": 10
      },
      {
        "id": 4,
        "name": "dist_20251201_093000",
        "path": "/var/www/project/dist_20251201_093000",
        "createdAt": "2025-12-01T09:30:00.000Z",
        "deploymentId": 9
      },
      {
        "id": 3,
        "name": "dist_20251130_180000",
        "path": "/var/www/project/dist_20251130_180000",
        "createdAt": "2025-11-30T18:00:00.000Z",
        "deploymentId": 8
      }
    ]
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| versions[].id | number | å¿«ç…§ IDï¼Œå›æ»šæ—¶ä½¿ç”¨æ­¤ ID |
| versions[].name | string | å¤‡ä»½ç›®å½•åç§°ï¼Œæ ¼å¼ä¸º `{åŸç›®å½•å}_{YYYYMMDD}_{HHMMSS}` |
| versions[].path | string | æœåŠ¡å™¨ä¸Šçš„å®Œæ•´å¤‡ä»½è·¯å¾„ |
| versions[].createdAt | string | å¤‡ä»½åˆ›å»ºæ—¶é—´ï¼ˆISO 8601 æ ¼å¼ï¼‰ |
| versions[].deploymentId | number | å…³è”çš„éƒ¨ç½²è®°å½• ID |

**é”™è¯¯å“åº”**
```json
{
  "success": false,
  "error": "é¡¹ç›®ç¯å¢ƒé…ç½®ä¸å­˜åœ¨"
}
```

---

### 2. å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬

**è¯·æ±‚**
```
POST /api/snapshots/:snapshotId/rollback
```

**å‚æ•°**
| å‚æ•° | ä½ç½® | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|------|
| snapshotId | path | number | æ˜¯ | å¿«ç…§ IDï¼ˆä»ç‰ˆæœ¬åˆ—è¡¨æ¥å£è·å–çš„ `id` å­—æ®µï¼‰ |

**è¯·æ±‚å¤´**
```
Authorization: Bearer <token>
```

**è¯·æ±‚ä½“**
æ— éœ€è¯·æ±‚ä½“

**å“åº”ç¤ºä¾‹ï¼ˆæˆåŠŸï¼‰**
```json
{
  "success": true,
  "data": {
    "id": 11,
    "status": "success",
    "snapshotId": 5
  },
  "message": "å›æ»šä»»åŠ¡å·²å®Œæˆ"
}
```

**å“åº”å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| data.id | number | æ–°åˆ›å»ºçš„éƒ¨ç½²è®°å½• IDï¼ˆå›æ»šä¹Ÿä¼šåˆ›å»ºä¸€æ¡éƒ¨ç½²è®°å½•ï¼‰ |
| data.status | string | å›æ»šçŠ¶æ€ï¼š`success` æˆ– `failed` |
| data.snapshotId | number | å›æ»šçš„ç›®æ ‡å¿«ç…§ ID |

**é”™è¯¯å“åº”**
```json
{
  "success": false,
  "error": "å¿«ç…§ä¸å­˜åœ¨"
}
```

```json
{
  "success": false,
  "error": "è¯¥å¿«ç…§ä¸æ”¯æŒå›æ»šï¼ˆé Push æ¨¡å¼éƒ¨ç½²ï¼‰"
}
```

```json
{
  "success": false,
  "error": "å¤‡ä»½ç›®å½•ä¸å­˜åœ¨: /var/www/project/dist_20251201_103000"
}
```

---

## ç§»åŠ¨ç«¯ UI å»ºè®®

### 1. ç‰ˆæœ¬åˆ—è¡¨é¡µé¢

å»ºè®®åœ¨é¡¹ç›®ç¯å¢ƒè¯¦æƒ…é¡µæˆ–éƒ¨ç½²å†å²é¡µé¢æ·»åŠ ã€Œå†å²ç‰ˆæœ¬ã€å…¥å£ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å†å²ç‰ˆæœ¬                     å…± 3 ä¸ª â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¦ dist_20251201_103000            â”‚
â”‚     2025-12-01 10:30:00             â”‚
â”‚                          [å›æ»š]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¦ dist_20251201_093000            â”‚
â”‚     2025-12-01 09:30:00             â”‚
â”‚                          [å›æ»š]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¦ dist_20251130_180000            â”‚
â”‚     2025-11-30 18:00:00             â”‚
â”‚                          [å›æ»š]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. å›æ»šç¡®è®¤å¼¹çª—

ç‚¹å‡»ã€Œå›æ»šã€æŒ‰é’®æ—¶ï¼Œå»ºè®®æ˜¾ç¤ºç¡®è®¤å¼¹çª—ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ç¡®è®¤å›æ»šï¼Ÿ                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  å³å°†å›æ»šåˆ°ç‰ˆæœ¬:                     â”‚
â”‚  dist_20251201_103000               â”‚
â”‚                                     â”‚
â”‚  âš ï¸ å½“å‰ç‰ˆæœ¬å°†è¢«å¤‡ä»½ï¼Œå¯å†æ¬¡å›æ»š     â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      [å–æ¶ˆ]          [ç¡®è®¤å›æ»š]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. å›æ»šè¿›åº¦/ç»“æœ

å›æ»šå®Œæˆåæ˜¾ç¤ºç»“æœï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           âœ… å›æ»šæˆåŠŸ                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  å·²æˆåŠŸå›æ»šåˆ°ç‰ˆæœ¬:                   â”‚
â”‚  dist_20251201_103000               â”‚
â”‚                                     â”‚
â”‚  åŸç‰ˆæœ¬å·²å¤‡ä»½ä¸º:                     â”‚
â”‚  dist_20251201_143000               â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              [ç¡®å®š]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flutter ä»£ç ç¤ºä¾‹

### Model å®šä¹‰

```dart
// lib/models/backup_version.dart

class BackupVersion {
  final int id;
  final String name;
  final String path;
  final DateTime createdAt;
  final int deploymentId;

  BackupVersion({
    required this.id,
    required this.name,
    required this.path,
    required this.createdAt,
    required this.deploymentId,
  });

  factory BackupVersion.fromJson(Map<String, dynamic> json) {
    return BackupVersion(
      id: json['id'],
      name: json['name'],
      path: json['path'],
      createdAt: DateTime.parse(json['createdAt']),
      deploymentId: json['deploymentId'],
    );
  }

  /// æ ¼å¼åŒ–æ˜¾ç¤ºæ—¶é—´
  String get formattedTime {
    return '${createdAt.year}-${createdAt.month.toString().padLeft(2, '0')}-${createdAt.day.toString().padLeft(2, '0')} '
           '${createdAt.hour.toString().padLeft(2, '0')}:${createdAt.minute.toString().padLeft(2, '0')}';
  }
}
```

### API Service

```dart
// lib/services/version_service.dart

import 'package:dio/dio.dart';
import '../models/backup_version.dart';

class VersionService {
  final Dio _dio;

  VersionService(this._dio);

  /// è·å–å¯å›æ»šç‰ˆæœ¬åˆ—è¡¨
  Future<List<BackupVersion>> getVersions(int projectEnvironmentId) async {
    final response = await _dio.get(
      '/api/project-environments/$projectEnvironmentId/versions',
    );

    if (response.data['success'] == true) {
      final versions = response.data['data']['versions'] as List;
      return versions.map((v) => BackupVersion.fromJson(v)).toList();
    }

    throw Exception(response.data['error'] ?? 'è·å–ç‰ˆæœ¬åˆ—è¡¨å¤±è´¥');
  }

  /// å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬
  Future<Map<String, dynamic>> rollbackToVersion(int snapshotId) async {
    final response = await _dio.post(
      '/api/snapshots/$snapshotId/rollback',
    );

    if (response.data['success'] == true) {
      return response.data['data'];
    }

    throw Exception(response.data['error'] ?? 'å›æ»šå¤±è´¥');
  }
}
```

### Riverpod Provider

```dart
// lib/providers/version_provider.dart

import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../models/backup_version.dart';
import '../services/version_service.dart';

// ç‰ˆæœ¬åˆ—è¡¨ Provider
final versionsProvider = FutureProvider.family<List<BackupVersion>, int>(
  (ref, projectEnvironmentId) async {
    final versionService = ref.read(versionServiceProvider);
    return versionService.getVersions(projectEnvironmentId);
  },
);

// å›æ»šçŠ¶æ€ Provider
final rollbackStateProvider = StateNotifierProvider<RollbackNotifier, AsyncValue<void>>(
  (ref) => RollbackNotifier(ref),
);

class RollbackNotifier extends StateNotifier<AsyncValue<void>> {
  final Ref _ref;

  RollbackNotifier(this._ref) : super(const AsyncValue.data(null));

  Future<void> rollback(int snapshotId) async {
    state = const AsyncValue.loading();
    try {
      final versionService = _ref.read(versionServiceProvider);
      await versionService.rollbackToVersion(snapshotId);
      state = const AsyncValue.data(null);
    } catch (e, st) {
      state = AsyncValue.error(e, st);
    }
  }
}
```

---

## æ³¨æ„äº‹é¡¹

1. **ä»… Push æ¨¡å¼æ”¯æŒ**: æ­¤å›æ»šåŠŸèƒ½ä»…é€‚ç”¨äº Push æ¨¡å¼ï¼ˆæœ¬åœ°æ„å»ºä¸Šä¼ ï¼‰éƒ¨ç½²çš„é¡¹ç›®ã€‚Pull æ¨¡å¼ï¼ˆè¿œç¨‹æ‹‰å–æ„å»ºï¼‰ä½¿ç”¨ Git å›æ»šã€‚

2. **å¤‡ä»½ç›®å½•æ¸…ç†**: ç›®å‰æ²¡æœ‰è‡ªåŠ¨æ¸…ç†æ—§å¤‡ä»½çš„ç­–ç•¥ï¼Œå¤‡ä»½ä¼šä¸€ç›´ä¿ç•™åœ¨æœåŠ¡å™¨ä¸Šã€‚åç»­å¯èƒ½ä¼šæ·»åŠ ä¿ç•™ç­–ç•¥ã€‚

3. **å›æ»šä¼šåˆ›å»ºæ–°å¤‡ä»½**: æ‰§è¡Œå›æ»šæ—¶ï¼Œå½“å‰ç‰ˆæœ¬ä¹Ÿä¼šè¢«å¤‡ä»½ï¼Œæ‰€ä»¥å¯ä»¥å†æ¬¡å›æ»šå›æ¥ã€‚

4. **å›æ»šæ˜¯åŒæ­¥æ“ä½œ**: å½“å‰å›æ»šæ¥å£æ˜¯åŒæ­¥ç­‰å¾…å®Œæˆçš„ï¼Œå¦‚æœæœåŠ¡å™¨å“åº”æ…¢ï¼Œå¯èƒ½éœ€è¦è®¾ç½®è¾ƒé•¿çš„è¶…æ—¶æ—¶é—´ã€‚

5. **æƒé™è¦æ±‚**: ä¸¤ä¸ªæ¥å£éƒ½éœ€è¦ç”¨æˆ·ç™»å½•ï¼ˆBearer Tokenï¼‰ï¼Œæ— éœ€ç‰¹æ®Šè§’è‰²æƒé™ã€‚

---

## ç›¸å…³æ–‡ä»¶

**åç«¯ä¿®æ”¹çš„æ–‡ä»¶**:
- `backend/src/models/DeploymentSnapshot.ts` - æ·»åŠ å¤‡ä»½ç›¸å…³å­—æ®µ
- `backend/src/services/DeploymentService.ts` - æ·»åŠ å¤‡ä»½å’Œå›æ»šé€»è¾‘
- `backend/src/controllers/DeploymentController.ts` - æ·»åŠ æ–°æ¥å£
- `backend/src/routes/index.ts` - æ·»åŠ æ–°è·¯ç”±

**æ•°æ®åº“å˜æ›´**:
- `deployment_snapshots` è¡¨æ–°å¢å­—æ®µ:
  - `backup_path` VARCHAR(255) - å¤‡ä»½å®Œæ•´è·¯å¾„
  - `backup_name` VARCHAR(100) - å¤‡ä»½ç›®å½•å
  - `deploy_mode` VARCHAR(20) - éƒ¨ç½²æ¨¡å¼ (push/pull)
